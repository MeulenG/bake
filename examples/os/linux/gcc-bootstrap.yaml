project: 
  summary: The linux OS base
  description: |
    This is the base OS linux ingredient, which is used as the base for all
    other chef packages built for linux.
  author: Philip Meulengracht
  email: the_meulengracht@hotmail.com
  version: 1.0.0
  license: MIT

ingredients:
  base: false

recipes:
  - name: construct
    path: ./
    confinement: false
    steps:
    - name: construct
      type: script
      script: |
        SYSROOT="${{ INSTALL_PREFIX }}"
        install_package() {
          FILES=$(dpkg-query -L "$1")
          for f in $FILES
          do
            echo "Installing $f"
            if [ -d "$f" ]; then
              mkdir -p "$SYSROOT"/"$f"
            else
              cp "$f" "$SYSROOT"/"$f"
            fi
          done
        }
        
        PACKAGES=(
          libc6-dev
          libgmp3-dev
          libmpc-dev
          binutils-dev
          libmpfr-dev
          libelf-dev
          zlib1g-dev
          gcc
          g++
          coreutils
          dash
          debianutils
          diffutils
          findutils
          grep
          gzip
          perl-base
          sed
          tar
          make
          autoconf
          libtool
          gawk
          flex
          bison
          texinfo
        )
        for pkg in "${PACKAGES[@]}"
        do
          install_package "$pkg"
        done

packs:
- name: gcc-bootstrap
  type: ingredient
